#!/usr/bin/env bash
#TODO deal with duplicate titles and better mpc add function
#TODO should clear?
# all songs
song(){
	song=$(mpc list title | rofi -dmenu -i -no-custom -p "song") || exit
	play-mode
	mpc findadd title "$song"
	mpc play
}

# all albums
album(){
	album=$(mpc list album | rofi -dmenu -i -no-custom -p "album") || exit
	play-mode
	mpc findadd album "$album"
	mpc play
}

# album from artist
artist-album(){
	artist=$(mpc list albumartist | rofi -dmenu -i -no-custom -p "artist") || exit
	album=$(mpc list album albumartist "$artist" | rofi -dmenu -i -no-custom -p "album") || exit
	play-mode
	mpc findadd album "$album"
	mpc play
}	

# song from artist
artist-song(){
	artist=$(mpc list artist | rofi -dmenu -i -no-custom -p "artist") || exit
	song=$(mpc list title artist "$artist" | rofi -dmenu -i -no-custom -p "song") || exit
	play-mode
	mpc findadd title "$song"
	mpc play
}	

# all playlists
playlist(){
	playlist=$( mpc lsplaylist | rofi -dmenu -i -no-custom -p "playlist") || exit
	play-mode
	mpc load $playlist
	mpc play
}

# all modes
mode(){
	mode=$(printf "song\nalbum\nartist song\nartist album\nplaylist" | rofi -dmenu -i -no-custom -p "mode" | sed 's/ /-/g')
	$mode
}

# play mode
play-mode(){
	mode=$(printf "add\nreplace" | rofi -dmenu -i -no-custom -p "mode")
case "$mode" in
"add")
	echo ;;
"replace")
	mpc clear ;; 
esac
}

# get current song
song-cur(){
	mpc | tail -2 | head -1 | awk '{print $2}' | sed 's/#//' | awk -F/ '{print $1}'
}

# get playlist length
song-end(){
	mpc playlist | wc -l
}

# jump forward in playlsit
jump-song(){
	for n in $(seq 1 $1); do
		mpc next
	done
}

case "$1" in
"-s"|"--song")
	song ;;
"-a"|"--album")
	album ;;
"-S"|"--artist-song")
  artist-song ;;
"-A"|"--arist-album")
  artist-album ;;
"-p"|"--playlist")
	playlist ;;
"-m"|"--mode")
	mode ;;
*)
	echo "Usage: $(basename $0) [option]"
	echo "  -s, --song             pick a song"
	echo "  -a, --album            pick an album"
	echo "  -S, --artist-song      pick an artist, then a song"
	echo "  -A, --arist-album      pick an artist, then an album"
	echo "  -p, --playlist         pick a playlist"
esac
